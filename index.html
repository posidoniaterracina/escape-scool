<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Escape School - Planimetria</title>

<style>
* { margin:0; padding:0; box-sizing:border-box; }

body {
    overflow:hidden;
    background:#0f172a;
    font-family:Arial;
}

#camera {
    width:100vw;
    height:100vh;
    overflow:hidden;
    position:relative;
    cursor:grab;
}

#map {
    position:absolute;
    width:2200px;
    height:1400px;
    background:white;
    transform-origin:0 0;
}

/* ===== MURI ===== */

.room {
    position:absolute;
    background:white;
    border:16px solid black;
}

/* ===== DISTRIBUZIONE PLANIMETRICA ===== */

#a1 { top:100px; left:200px; width:500px; height:300px; }
#a2 { top:100px; left:700px; width:500px; height:300px; }
#a3 { top:100px; left:1200px; width:500px; height:300px; }

#corr {
    position:absolute;
    top:400px;
    left:200px;
    width:1500px;
    height:200px;
    border-top:16px solid black;
    border-bottom:16px solid black;
}

#a4 { top:600px; left:200px; width:600px; height:400px; }
#bagno { top:600px; left:800px; width:300px; height:300px; }
#presidenza { top:600px; left:1100px; width:600px; height:400px; }

/* ===== PORTE IN PIANTA ===== */

.door {
    position:absolute;
    width:120px;
    height:120px;
    border:4px solid black;
    border-left:none;
    border-bottom:none;
    background:transparent;
    transform-origin:0 100%;
    transform:rotate(0deg);
    transition:transform 0.6s ease;
    cursor:pointer;
}

.door.open {
    transform:rotate(-90deg);
}

/* POSIZIONAMENTO PORTE */

#a1 .door { bottom:-16px; left:180px; }
#a2 .door { bottom:-16px; left:180px; }
#a3 .door { bottom:-16px; left:180px; }

#a4 .door { top:-16px; left:250px; }
#bagno .door { top:-16px; left:90px; }
#presidenza .door { top:-16px; left:250px; }

</style>
</head>

<body>

<div id="camera">
    <div id="map">

        <div id="a1" class="room"><div class="door"></div></div>
        <div id="a2" class="room"><div class="door"></div></div>
        <div id="a3" class="room"><div class="door"></div></div>

        <div id="corr"></div>

        <div id="a4" class="room"><div class="door"></div></div>
        <div id="bagno" class="room"><div class="door"></div></div>
        <div id="presidenza" class="room"><div class="door"></div></div>

    </div>
</div>

<script>
const map = document.getElementById("map");
const camera = document.getElementById("camera");

let scale = 1;
let pos = { x: -300, y: -200 };
let velocity = { x: 0, y: 0 };
let last = null;

function animate() {
    pos.x += velocity.x;
    pos.y += velocity.y;
    velocity.x *= 0.92;
    velocity.y *= 0.92;
    map.style.transform =
        `translate(${pos.x}px, ${pos.y}px) scale(${scale})`;
    requestAnimationFrame(animate);
}
animate();

/* DRAG */
camera.addEventListener("mousedown", e => {
    last = { x:e.clientX, y:e.clientY };
    camera.onmousemove = ev => {
        velocity.x = ev.clientX - last.x;
        velocity.y = ev.clientY - last.y;
        last = { x:ev.clientX, y:ev.clientY };
    };
});
window.addEventListener("mouseup", () => camera.onmousemove = null);

/* ZOOM */
camera.addEventListener("wheel", e => {
    e.preventDefault();
    scale *= e.deltaY < 0 ? 1.1 : 0.9;
    scale = Math.min(Math.max(scale, 0.4), 3);
});

/* APERTURA PORTA */
document.querySelectorAll(".door").forEach(d => {
    d.addEventListener("click", e => {
        e.stopPropagation();
        d.classList.toggle("open");
    });
});
</script>

</body>
</html>
